{"version":3,"file":"preact.js","sources":["src/integrations/preact.js"],"sourcesContent":["const { useLayoutEffect } = require('preact/hooks')\n\nconst getScrollPosition = () => {\n  try {\n    return { x: window.scrollX, y: window.scrollY }\n  } catch (err) {\n    console.error('getScrollPosition err:', err.message)\n    return { x: 0, y: 0 }\n  }\n}\n\nlet hasScrollListener = false\n\nexports.useScrollPosition = (effect, dependencies, wait) => {\n  let waitTimeout, prevPosition = 0\n\n  const callBack = () => {\n    const position = getScrollPosition()\n    const direction = prevPosition.y > position.y ? 'up' : 'down'\n\n    effect({ position, direction })\n    waitTimeout = null\n    prevPosition = position\n  }\n\n  useLayoutEffect(() => {\n    const handleScroll = () => {\n      if (wait && waitTimeout == null) {\n        waitTimeout = setTimeout(callBack, wait)\n      } else if (!wait) { callBack() }\n    }\n\n    try {\n      window.addEventListener('scroll', handleScroll)\n      hasScrollListener = true\n    } catch (err) {\n      console.error('useScrollPosition err:', err.message)\n    }\n\n    return () => hasScrollListener && window.removeEventListener('scroll', handleScroll)\n  }, dependencies)\n}\n\nexports.isWithinView = ({\n  y = 0,\n  key,\n  id,\n  ref,\n  class: elementClass,\n  skipEl,\n  offset = 0,\n  repeatedly = true,\n  addParentOffset = false,\n  add,\n  skipCb,\n  testDocument,\n  cb\n}) => {\n  if (skipEl || (!id && !elementClass && typeof ref === 'undefined')) return\n\n  try {\n    const idOrClass = id || elementClass\n    const element = (ref && ref.current) || (testDocument || document).querySelector(idOrClass)\n\n    if (!element) {\n      const msg = typeof ref !== 'undefined' ? 'Element using ref' : `Element '${id || elementClass}'`\n      return console.error(`isWithinView err: ${msg} was not found.`)\n    }\n\n    if (addParentOffset) {\n      offset += element.offsetParent.offsetTop\n    }\n\n    const elPosition = testDocument\n      ? element.dataset.offsettop - element.dataset.innerheight + offset\n      : element.offsetTop - window.innerHeight + offset\n\n    if (y > elPosition) {\n      element.classList.add(add)\n      if (cb) { cb(key) }\n      return true\n    } else {\n      if (repeatedly) { element.classList.remove(add) }\n      return false\n    }\n  } catch (err) {\n    console.error('isWithinView err:', err.message)\n    return false\n  }\n}\n"],"names":["useLayoutEffect","require","hasScrollListener","exports","useScrollPosition","effect","dependencies","wait","waitTimeout","prevPosition","callBack","position","x","window","scrollX","y","scrollY","err","console","error","message","getScrollPosition","direction","handleScroll","setTimeout","addEventListener","removeEventListener","isWithinView","key","id","ref","elementClass","offset","repeatedly","addParentOffset","add","testDocument","cb","skipEl","element","current","document","querySelector","offsetParent","offsetTop","dataset","offsettop","innerheight","innerHeight","classList","remove"],"mappings":"IAAQA,EAAoBC,QAAQ,gBAA5BD,gBAWJE,GAAoB,EAExBC,QAAQC,kBAAoB,SAACC,EAAQC,EAAcC,GACjD,IAAIC,EAAaC,EAAe,EAE1BC,EAAW,WACf,IAAMC,EAfgB,WACxB,IACE,MAAO,CAAEC,EAAGC,OAAOC,QAASC,EAAGF,OAAOG,SACtC,MAAOC,GAEP,OADAC,QAAQC,MAAM,yBAA0BF,EAAIG,SACrC,CAAER,EAAG,EAAGG,EAAG,IAUDM,GAGjBhB,EAAO,CAAEM,SAAAA,EAAUW,UAFDb,EAAaM,EAAIJ,EAASI,EAAI,KAAO,SAGvDP,EAAc,KACdC,EAAeE,GAGjBX,EAAgB,WACd,IAAMuB,EAAe,WACfhB,GAAuB,MAAfC,EACVA,EAAcgB,WAAWd,EAAUH,GACzBA,GAAQG,KAGtB,IACEG,OAAOY,iBAAiB,SAAUF,GAClCrB,GAAoB,EACpB,MAAOe,GACPC,QAAQC,MAAM,yBAA0BF,EAAIG,SAG9C,yBAAalB,GAAqBW,OAAOa,oBAAoB,SAAUH,KACtEjB,IAGLH,QAAQwB,aAAe,oBACrBZ,EAAAA,aAAI,IACJa,IAAAA,IACAC,IAAAA,GACAC,IAAAA,IACOC,cAEPC,OAAAA,aAAS,QACTC,WAAAA,oBACAC,gBAAAA,gBACAC,IAAAA,IAEAC,IAAAA,aACAC,IAAAA,GAEA,MATAC,SASgBT,GAAOE,QAA+B,IAARD,GAE9C,IACE,IACMS,EAAWT,GAAOA,EAAIU,UAAaJ,GAAgBK,UAAUC,cADjDb,GAAME,GAGxB,OAAKQ,GAKDL,IACFF,GAAUO,EAAQI,aAAaC,WAO7B7B,GAJeqB,EACfG,EAAQM,QAAQC,UAAYP,EAAQM,QAAQE,YAAcf,EAC1DO,EAAQK,UAAY/B,OAAOmC,YAAchB,IAG3CO,EAAQU,UAAUd,IAAIA,GAClBE,GAAMA,EAAGT,QAGTK,GAAcM,EAAQU,UAAUC,OAAOf,QAhBpCjB,QAAQC,iCADY,IAARW,EAAsB,iCAAkCD,GAAME,2BAoBnF,MAAOd,GAEP,OADAC,QAAQC,MAAM,oBAAqBF,EAAIG"}