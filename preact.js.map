{"version":3,"file":"preact.js","sources":["src/integrations/preact.js"],"sourcesContent":["const { useLayoutEffect } = require('preact/hooks')\n\nconst getScrollPosition = () => {\n  try {\n    return { x: window.scrollX, y: window.scrollY }\n  } catch (err) {\n    console.error('getScrollPosition err:', err.message)\n    return { x: 0, y: 0 }\n  }\n}\n\nlet hasScrollListener = false\n\nexports.useScrollPosition = (effect, dependencies, wait) => {\n  let waitTimeout; let prevPosition = 0\n\n  const callBack = () => {\n    const position = getScrollPosition()\n    const direction = prevPosition.y > position.y ? 'up' : 'down'\n\n    effect({ position, direction })\n    waitTimeout = null\n    prevPosition = position\n  }\n\n  useLayoutEffect(() => {\n    const handleScroll = () => {\n      if (wait && waitTimeout == null) {\n        waitTimeout = setTimeout(callBack, wait)\n      } else if (!wait) { callBack() }\n    }\n\n    try {\n      window.addEventListener('scroll', handleScroll)\n      hasScrollListener = true\n    } catch (err) {\n      console.error('useScrollPosition err:', err.message)\n    }\n\n    return () => hasScrollListener && window.removeEventListener('scroll', handleScroll)\n  }, dependencies)\n}\n\nexports.isWithinView = ({\n  y = 0,\n  key,\n  id,\n  ref,\n  class: elementClass,\n  query,\n  skipEl,\n  offset = 0,\n  repeatedly = true,\n  addParentOffset = false,\n  add,\n  skipCb,\n  testDocument,\n  cb\n}) => {\n  if (skipEl || (!id && !query && !elementClass && typeof ref === 'undefined')) return\n\n  try {\n    let element = null\n\n    if (ref && ref.current) {\n      element = ref.current\n    } else if (id) {\n      element = (testDocument || document).getElementById(id)\n    } else if (elementClass) {\n      element = (testDocument || document).getElementsByClassName(elementClass)[0]\n    } else if (query) {\n      element = (testDocument || document).querySelector(query)\n    }\n\n    if (!element) {\n      const msg = typeof ref !== 'undefined' ? 'Element using ref' : `Element '${id || elementClass || query}'`\n      return console.error(`isWithinView err: ${msg} was not found.`)\n    }\n\n    if (addParentOffset) {\n      offset += element.offsetParent.offsetTop\n    }\n\n    const elPosition = testDocument\n      ? element.dataset.offsettop - element.dataset.innerheight + offset\n      : element.offsetTop - window.innerHeight + offset\n\n    if (y > elPosition) {\n      element.classList.add(add)\n      if (cb) { cb(key) }\n      return true\n    } else {\n      if (repeatedly) { element.classList.remove(add) }\n      return false\n    }\n  } catch (err) {\n    console.error('isWithinView err:', err.message)\n    return false\n  }\n}\n"],"names":["useLayoutEffect","require","hasScrollListener","exports","useScrollPosition","effect","dependencies","wait","waitTimeout","prevPosition","callBack","position","x","window","scrollX","y","scrollY","err","console","error","message","getScrollPosition","direction","handleScroll","setTimeout","addEventListener","removeEventListener","isWithinView","key","id","ref","elementClass","query","offset","repeatedly","addParentOffset","add","testDocument","cb","skipEl","element","current","document","getElementById","getElementsByClassName","querySelector","offsetParent","offsetTop","dataset","offsettop","innerheight","innerHeight","classList","remove"],"mappings":"IAAQA,EAAoBC,QAAQ,gBAA5BD,gBAWJE,GAAoB,EAExBC,QAAQC,kBAAoB,SAACC,EAAQC,EAAcC,GACjD,IAAIC,EAAiBC,EAAe,EAE9BC,EAAW,WACf,IAAMC,EAfgB,WACxB,IACE,MAAO,CAAEC,EAAGC,OAAOC,QAASC,EAAGF,OAAOG,SACtC,MAAOC,GAEP,OADAC,QAAQC,MAAM,yBAA0BF,EAAIG,SACrC,CAAER,EAAG,EAAGG,EAAG,IAUDM,GAGjBhB,EAAO,CAAEM,SAAAA,EAAUW,UAFDb,EAAaM,EAAIJ,EAASI,EAAI,KAAO,SAGvDP,EAAc,KACdC,EAAeE,GAGjBX,EAAgB,WACd,IAAMuB,EAAe,WACfhB,GAAuB,MAAfC,EACVA,EAAcgB,WAAWd,EAAUH,GACzBA,GAAQG,KAGtB,IACEG,OAAOY,iBAAiB,SAAUF,GAClCrB,GAAoB,EACpB,MAAOe,GACPC,QAAQC,MAAM,yBAA0BF,EAAIG,SAG9C,yBAAalB,GAAqBW,OAAOa,oBAAoB,SAAUH,KACtEjB,IAGLH,QAAQwB,aAAe,oBACrBZ,EAAAA,aAAI,IACJa,IAAAA,IACAC,IAAAA,GACAC,IAAAA,IACOC,UACPC,IAAAA,UAEAC,OAAAA,aAAS,QACTC,WAAAA,oBACAC,gBAAAA,gBACAC,IAAAA,IAEAC,IAAAA,aACAC,IAAAA,GAEA,MATAC,SASgBV,GAAOG,GAAUD,QAA+B,IAARD,GAExD,IACE,IAAIU,EAAU,KAYd,OAVIV,GAAOA,EAAIW,QACbD,EAAUV,EAAIW,QACLZ,EACTW,GAAWH,GAAgBK,UAAUC,eAAed,GAC3CE,EACTS,GAAWH,GAAgBK,UAAUE,uBAAuBb,GAAc,GACjEC,IACTQ,GAAWH,GAAgBK,UAAUG,cAAcb,IAGhDQ,GAKDL,IACFF,GAAUO,EAAQM,aAAaC,WAO7BhC,GAJesB,EACfG,EAAQQ,QAAQC,UAAYT,EAAQQ,QAAQE,YAAcjB,EAC1DO,EAAQO,UAAYlC,OAAOsC,YAAclB,IAG3CO,EAAQY,UAAUhB,IAAIA,GAClBE,GAAMA,EAAGV,QAGTM,GAAcM,EAAQY,UAAUC,OAAOjB,QAhBpClB,QAAQC,iCADY,IAARW,EAAsB,iCAAkCD,GAAME,GAAgBC,2BAoBnG,MAAOf,GAEP,OADAC,QAAQC,MAAM,oBAAqBF,EAAIG"}